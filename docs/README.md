# NetbankingSDK Usage Guide

Netbanking SDK allows you to get information about user's profile, accounts, cards and payment orders from Česká spořitelna a.s.

## Before You Begin

Before using CoreSDK in your application, you need to initialize it by providing it your WebApiKey.

```swift
func application(application: UIApplication, didFinishLaunchingWithOptions launchOptions: [NSObject: AnyObject]?) -> Bool {
        CoreSDK.sharedInstance
            .useWebApiKey("YourApiKey")
            .useEnvironment(Environment.Sandbox)
        //Now you are ready to setup the netbanking client
        let config = WebApiConfiguration(webApiKey: "YourApiKey", environment: Environment.Sandbox, language: "cs-CZ", signingKey: nil)
        //And obtain it
        let netbankingClient = NetbankingClient(config: config)
    }
```

For more configuration options see **[CoreSDK configuration guide](https://github.com/Ceskasporitelna/cs-core-sdk-ios/blob/master/docs/configuration.md)**

## Functionality

Netbanking SDK provides the following functionality:

- [**Accounts**](./accounts.md) - List all of user's accounts, get detail of an individual account and additional information about it.
- [**AuthorizationLimits**](./authorizationLimits.md) - Return payment limits for all authorization methods and channels.
- [**AuthorizationToken**](./authorizationToken.md) - Invalidate user's token.
- [**Budgets**](./budgets.md) - List watched categories of transactions and create new ones.
- [**Bundles**](./bundles.md) - Combine multiple payment orders into a bundle that can be signed at once.
- [**Cards**](./cards.md) - List all of user's cards, get detail of an individual card and additional information about it.
- [**Contacts**](./contacts.md) - List user's contact infomation (addresses, phone nubers, e-mails).
- [**Contracts**](./contracts.md) - List and manipulate with contracts of the user. These include:

  - savings,
  - insurances,
  - pensions,
  - iBod program.

- [**Goals**](./goals.md) - List & change saving goals (currently one only) of current user.
- [**Messages**](./messages.md) - Get & manage all messages for current user generated by bank itself.
- [**Orders**](./orders.md) - Get list of payment orders for accounts for the current user, create domestic payment orders and get infomation about user's limits.
- [**Securities**](./securities.md) - List securities accounts for current user. Securities account represents virtual account which holds securities titles and its shares (funds, bonds, etc.). Change settings or make notes about transactions.
- [**Services**](./services.md) - List services for current user.
- [**Settings**](./settings.md) - View and modify user settings.
- [**PhoneNumbers**](./phoneNumbers.md) - User's phone book.
- [**Plugins**](./plugins.md) - Enable or disable plugins.
- [**Profile**](./profile.md) - Get detail of the current user and information about his last logins.
- [**Promotions**](./promotions) - Get list of available promotions for the current user.
- [**Templates**](./templates.md) - List of payment templates for current user.

To get resource instances see the following code snippet.

```swift
let config = WebApiConfiguration(webApiKey: "YOUR_API_KEY", environment: Environment.Production, language: "cs-CZ", signingKey: nil)

    //create client
    let netbankingClient = NetbankingClient(config: config)

    // Get xxxResource Instance
    netbankingClient.xxx
```

## Usage

This usage guide walks you through ..

## General concepts

### Pagination

Resources that supports pagination implement `OptionalPaginatedListEnabled` protocol (for example [`MessagesResource`](../CSNetbankingSDK/MessagesResource.swift)). If thats the case you can (and should) pass the corresponding object with properties `pageNumber` and `pageSize` to the `list` method. There is no SDK default pagination so if you do not pass pagination parameters then you get whatever the server decides so we strongly recommend you use pagination parameters.

```swift
let pagination = Pagination(pageNumber: 0, // number of the page
                                    pageSize: 20) // number of items on each page
    let params = MessagesParameters(pagination: pagination, sortBy: nil)

    netbankingClient.messages.list(params){ result in
        switch result{
        case .Success(let response):
            response.pagination.hasNextPage // is more pages available
            response.pagination.pageCount  // number of pages available
            response.pagination.pageNumber // actual number of the page
            response.pagination.pageSize   // number of items on each page

        case .Failure(let error):
            print(error.localizedDescription)
        }
    }
```

### Sorting

Objects that support server side sorting have an array of tupples (`sort`,`order`) as a parameter. These objects' parameter implement [`Sortable`](https://github.com/Ceskasporitelna/cs-core-sdk-ios/blob/master/CoreSDK/Sortable.swift) protocol.

- `sort` we recomend use Enum implementing protocol [`MessagesSortableFields`](../CSNetbankingSDK/MessagesParameters.swift) or you can String.
- `order` is and Enum [`SortDirection`](https://github.com/Ceskasporitelna/cs-core-sdk-ios/blob/master/CoreSDK/Sortable.swift).

```swift
let sortBy = Sort(by: [(MessagesSortableFields.from,  // sorty by name
                               SortDirection.Ascending),  // Ascending
                              (MessagesSortableFields.id, // sort by type (from, id)
                               SortDirection.Ascending)]) // Ascending
    let params =  MessagesParameters(pagination: nil, sort: sortBy)

     netbankingClient.messages.list(params){ result in
        switch result{
        case .Success(let response):
           for message in response.items { // places sorted by preferences..
           //
           }
        case .Failure(let error):
            print(error.localizedDescription)
        }
    }
```

**Note:** Many resources (i.e. `MessagesResource`) support both Pagination and Sorting.

### Signing

Most of the write operations (such as creating payment order or modifying user's settings) done through Netbanking SDK need to be signed. See **[signing guide](./signing.md)** to learn more about signing.

## Demo

Check out the [demo application](https://github.com/Ceskasporitelna/csas-sdk-demo-ios) for usage demonstration.

## Further documentation

You can look into the source code of this repository to see documented classes and methods of this SDK.

This SDK communicates with Netbanking API. You can have a look at its [documentation](http://docs.ext0csasnetbanking3.apiary.io/#).
